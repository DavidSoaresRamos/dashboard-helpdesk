<div class="header">
  <div class="title">
    <h1>DISPOSITIVOS</h1>
  </div>

  <div class="summary">
    <span class="available">DisponÃ­veis: {{ availableCount }}</span>
    <span class="inuse">Em uso: {{ inUseCount }}</span>
  </div>

  <div class="actions">
    <button class="refresh" (click)="getDevices()">
      <i class="fa-solid fa-arrows-rotate"></i> Atualizar
    </button>
    <button class="add" (click)="openModal()">
      <i class="fa-solid fa-plus"></i> Adicionar Dispositivo
    </button>
  </div>
</div>

<div class="filters">
  <label>Status:</label>
  <select [(ngModel)]="filterStatus" (change)="applyFilters()">
    <option value="all">Todos</option>
    <option value="DISPONIVEL">DisponÃ­veis</option>
    <option value="EM_USO">Em uso</option>
  </select>

  <button class="sort" (click)="toggleSort()">
    Ordenar por NÂº Dispositivo
    <mat-icon>{{ sortAscending ? 'arrow_upward' : 'arrow_downward' }}</mat-icon>
  </button>
</div>

<div class="fields">
  <mat-table [dataSource]="filteredData" class="mat-elevation-z8">
    <ng-container matColumnDef="name">
      <mat-header-cell *matHeaderCellDef>Colaborador</mat-header-cell>
      <mat-cell *matCellDef="let element">{{element.name}}</mat-cell>
    </ng-container>

    <ng-container matColumnDef="deviceNumber">
      <mat-header-cell *matHeaderCellDef>NÂº do Dispositivo</mat-header-cell>
      <mat-cell *matCellDef="let element">{{element.deviceNumber}}</mat-cell>
    </ng-container>

    <ng-container matColumnDef="snid">
      <mat-header-cell *matHeaderCellDef>SNID</mat-header-cell>
      <mat-cell *matCellDef="let element">{{element.snid}}</mat-cell>
    </ng-container>

    <ng-container matColumnDef="model">
      <mat-header-cell *matHeaderCellDef>Modelo</mat-header-cell>
      <mat-cell *matCellDef="let element">{{element.model}}</mat-cell>
    </ng-container>

    <ng-container matColumnDef="chargerNumber">
      <mat-header-cell *matHeaderCellDef>NÂº do Carregador</mat-header-cell>
      <mat-cell *matCellDef="let element">{{element.chargerNumber}}</mat-cell>
    </ng-container>

    <ng-container matColumnDef="status">
      <mat-header-cell *matHeaderCellDef>Status</mat-header-cell>
      <mat-cell *matCellDef="let element">
        <span
          [ngClass]="{'status-available': element.status === 'DISPONIVEL', 'status-inuse': element.status === 'EM_USO'}">
          {{element.status === 'DISPONIVEL' ? 'DisponÃ­vel' : 'Em uso'}}
        </span>
      </mat-cell>
    </ng-container>

    <ng-container matColumnDef="actions">
      <mat-header-cell *matHeaderCellDef>AÃ§Ãµes</mat-header-cell>
      <mat-cell *matCellDef="let element">
        <button class="editButton" mat-icon-button color="primary" (click)="editDevice(element)">
         <i class="fa-solid fa-pen-to-square"></i>
        </button>
        <button class="deleteButton" mat-icon-button color="warn" (click)="deleteDevice(element)">
          <i class="fa-solid fa-trash"></i>
        </button>
      </mat-cell>
    </ng-container>

    <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
    <mat-row *matRowDef="let row; columns: displayedColumns"></mat-row>
  </mat-table>
</div>

<!-- ðŸ”¹ MODAL DE CADASTRO -->
<div class="modal" *ngIf="showModal">
  <div class="modal-content">
    <h2>Adicionar Novo Dispositivo</h2>
    <form>
      <input placeholder="Colaborador" [(ngModel)]="newDevice.name" name="name" />
      <input placeholder="NÂº do Dispositivo" [(ngModel)]="newDevice.deviceNumber" name="deviceNumber" />
      <input placeholder="SNID" [(ngModel)]="newDevice.snid" name="snid" />
      <input placeholder="Modelo" [(ngModel)]="newDevice.model" name="model" />
      <input placeholder="NÂº do Carregador" [(ngModel)]="newDevice.chargerNumber" name="chargerNumber" />
      <select [(ngModel)]="newDevice.status" name="status">
        <option value="DISPONIVEL">DisponÃ­vel</option>
        <option value="EM_USO">Em uso</option>
      </select>

      <div class="modal-actions">
        <button type="button" (click)="saveDevice()">Salvar</button>
        <button type="button" class="cancel" (click)="closeModal()">Cancelar</button>
      </div>
    </form>
  </div>
</div>